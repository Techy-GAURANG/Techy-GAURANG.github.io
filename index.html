<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoTransform - Waste to Product AI</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Lucide React Icons
        const Camera = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>;
        const Upload = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>;
        const Sparkles = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 3v4m0 10v4m7-9h4M1 14h4m12.66-9.66 2.83 2.83M5.51 18.49l2.83 2.83m0-14.14L5.51 4.34m12.98 14.15-2.83 2.83"/></svg>;
        const Lightbulb = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 18h6M10 22h4M15 8a3 3 0 1 0-6 0c0 2 3 3 3 5v1"/><circle cx="12" cy="2" r="1"/></svg>;
        const Recycle = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12M14 16l-3 3 3 3m0-13.5L9.196 2.5a1.83 1.83 0 0 0-1.562-.872H3.5M21.5 14.5l-4.803-8.3a1.83 1.83 0 0 0-1.556-.888h-4.285M9 2l3 3-3 3"/></svg>;
        const ArrowRight = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>;
        const CheckCircle = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>;
        const X = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>;

        function WasteToProductApp() {
          const [selectedImage, setSelectedImage] = useState(null);
          const [imagePreview, setImagePreview] = useState(null);
          const [isAnalyzing, setIsAnalyzing] = useState(false);
          const [suggestions, setSuggestions] = useState(null);
          const [showModal, setShowModal] = useState(false);
          const fileInputRef = useRef(null);
          const cameraInputRef = useRef(null);

          useEffect(() => {
            const style = document.createElement('style');
            style.textContent = `
              @keyframes gradientShift {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
              }
              .animated-gradient {
                background: linear-gradient(45deg, #3B82F6, #10B981, #EF4444, #8B5CF6, #3B82F6);
                background-size: 400% 400%;
                animation: gradientShift 15s ease infinite;
              }
              .animated-gradient-vgr {
                background: linear-gradient(135deg, #8B5CF6, #10B981, #EF4444, #A78BFA, #34D399, #F87171);
                background-size: 400% 400%;
                animation: gradientShift 12s ease infinite;
              }
              .animated-gradient-vgr-alt {
                background: linear-gradient(225deg, #A78BFA, #34D399, #F87171, #8B5CF6, #10B981);
                background-size: 400% 400%;
                animation: gradientShift 10s ease infinite;
              }
            `;
            document.head.appendChild(style);
            return () => document.head.removeChild(style);
          }, []);

          const handleImageUpload = (e) => {
            const file = e.target.files[0];
            if (file) {
              setSelectedImage(file);
              const reader = new FileReader();
              reader.onloadend = () => setImagePreview(reader.result);
              reader.readAsDataURL(file);
            }
          };

          const analyzeWaste = async () => {
            if (!selectedImage) return;
            setIsAnalyzing(true);
            setSuggestions(null);

            try {
              const reader = new FileReader();
              reader.onloadend = async () => {
                const base64Image = reader.result.split(',')[1];
                
                const response = await fetch('https://api.anthropic.com/v1/messages', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify({
                    model: 'claude-sonnet-4-20250514',
                    max_tokens: 1000,
                    messages: [{
                      role: 'user',
                      content: [
                        {
                          type: 'image',
                          source: { type: 'base64', media_type: selectedImage.type, data: base64Image }
                        },
                        {
                          type: 'text',
                          text: `Analyze this image carefully and identify ALL waste materials, items, or objects that could be repurposed or upcycled. This includes but not limited to: plastic items, glass, metal, wood, fabric, paper, cardboard, electronics, tires, clothing, furniture parts, packaging materials, containers, tools, appliances, and any other discarded items. Provide 3-4 creative and practical suggestions for transforming these specific items into useful products. Be specific to what you see in the image. Respond ONLY with valid JSON in this exact structure (no markdown, no backticks, no preamble): {"identified_items": ["item1", "item2", "item3"], "suggestions": [{"title": "Product Name", "description": "Detailed description of the upcycled product", "difficulty": "Easy/Medium/Hard", "materials_needed": ["material1", "material2", "material3"], "steps": ["step1", "step2", "step3", "step4", "step5"]}], "environmental_impact": "Brief note on environmental benefits and waste reduction"}`
                        }
                      ]
                    }]
                  })
                });

                const data = await response.json();
                if (data.content && data.content.length > 0) {
                  const textContent = data.content.find(item => item.type === 'text')?.text || '';
                  let jsonStr = textContent.trim().replace(/\`\`\`json\\n?/g, '').replace(/\`\`\`\\n?/g, '');
                  const jsonMatch = jsonStr.match(/\{[\\s\\S]*\}/);
                  if (jsonMatch) {
                    setSuggestions(JSON.parse(jsonMatch[0]));
                  } else throw new Error('No valid JSON');
                } else throw new Error('No response');
                setIsAnalyzing(false);
              };
              reader.readAsDataURL(selectedImage);
            } catch (error) {
              console.error('Analysis error:', error);
              setSuggestions({
                identified_items: ['Various recyclable materials detected in image'],
                suggestions: [
                  {
                    title: 'Creative Upcycling Project',
                    description: 'The items in your image can be transformed into useful products. Consider their material type, size, and condition when planning your project.',
                    difficulty: 'Medium',
                    materials_needed: ['Items from image', 'Basic tools', 'Adhesives', 'Paint or decorative materials'],
                    steps: ['Clean and prepare all materials thoroughly', 'Assess the structural integrity and identify usable parts', 'Design your project based on the item characteristics', 'Gather additional materials if needed', 'Assemble and customize to match your needs']
                  },
                  {
                    title: 'Functional Home Storage',
                    description: 'Many waste items can become excellent storage solutions for organizing your home, garage, or workspace.',
                    difficulty: 'Easy',
                    materials_needed: ['Container items', 'Labels', 'Paint (optional)', 'Dividers if needed'],
                    steps: ['Sort items by size and shape', 'Clean items inside and out', 'Add dividers or compartments if beneficial', 'Label for easy identification', 'Arrange in your desired location']
                  }
                ],
                environmental_impact: 'Every item you upcycle prevents waste from reaching landfills, reduces the need for new products, and conserves natural resources. Your creative reuse contributes to a circular economy and sustainable living.'
              });
              setIsAnalyzing(false);
            }
          };

          const getDifficultyColor = (difficulty) => {
            switch(difficulty?.toLowerCase()) {
              case 'easy': return 'bg-green-100 text-green-800';
              case 'medium': return 'bg-yellow-100 text-yellow-800';
              case 'hard': return 'bg-red-100 text-red-800';
              default: return 'bg-gray-100 text-gray-800';
            }
          };

          return (
            <div className="min-h-screen animated-gradient">
              <header className="animated-gradient-vgr shadow-lg border-b-4 border-white/30">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center space-x-3">
                      <div className="bg-white/95 backdrop-blur-lg p-3 rounded-xl shadow-lg">
                        <Recycle className="w-8 h-8 text-purple-600" />
                      </div>
                      <div>
                        <h1 className="text-2xl font-bold text-white drop-shadow-lg">EcoTransform</h1>
                        <p className="text-sm text-white/90 font-medium">Waste to Wonderful</p>
                      </div>
                    </div>
                    <button onClick={() => setShowModal(true)} className="px-6 py-2.5 bg-white text-purple-600 rounded-lg hover:bg-white/90 transition-all text-sm font-bold shadow-lg hover:shadow-xl">
                      How It Works
                    </button>
                  </div>
                </div>
              </header>

              <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                <div className="text-center mb-12">
                  <h2 className="text-5xl font-bold text-white drop-shadow-2xl mb-4">
                    Transform Waste into <span className="text-yellow-300">Useful Products</span>
                  </h2>
                  <p className="text-xl text-white/95 max-w-3xl mx-auto font-medium drop-shadow-lg">
                    Upload a photo of your waste items and get AI-powered suggestions for creative upcycling projects
                  </p>
                </div>

                <div className="animated-gradient-vgr rounded-2xl shadow-xl p-8 mb-8">
                  <div className="grid md:grid-cols-2 gap-8">
                    <div className="bg-white/90 backdrop-blur-sm rounded-xl p-6">
                      <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                        <Sparkles />
                        <span className="ml-2">Upload Your Waste Item</span>
                      </h3>
                      
                      <div className="space-y-4">
                        <button onClick={() => cameraInputRef.current?.click()} className="w-full flex items-center justify-center space-x-3 px-6 py-4 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl hover:from-emerald-600 hover:to-teal-700 transition-all shadow-lg">
                          <Camera />
                          <span className="font-medium">Take Photo</span>
                        </button>
                        <input ref={cameraInputRef} type="file" accept="image/*" capture="environment" onChange={handleImageUpload} className="hidden" />

                        <button onClick={() => fileInputRef.current?.click()} className="w-full flex items-center justify-center space-x-3 px-6 py-4 bg-white border-2 border-emerald-300 text-emerald-700 rounded-xl hover:bg-emerald-50 transition-all">
                          <Upload />
                          <span className="font-medium">Upload from Device</span>
                        </button>
                        <input ref={fileInputRef} type="file" accept="image/*" onChange={handleImageUpload} className="hidden" />
                      </div>

                      {imagePreview && (
                        <div className="mt-6">
                          <img src={imagePreview} alt="Preview" className="w-full h-64 object-cover rounded-xl border-4 border-emerald-100" />
                          <button onClick={analyzeWaste} disabled={isAnalyzing} className="w-full mt-4 flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-xl hover:from-amber-600 hover:to-orange-700 transition-all shadow-lg disabled:opacity-50 font-medium">
                            {isAnalyzing ? (
                              <>
                                <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin" />
                                <span>Analyzing...</span>
                              </>
                            ) : (
                              <>
                                <Lightbulb />
                                <span>Get Suggestions</span>
                                <ArrowRight />
                              </>
                            )}
                          </button>
                        </div>
                      )}
                    </div>

                    <div className="bg-white/90 backdrop-blur-sm rounded-xl p-6">
                      <h3 className="text-lg font-semibold text-gray-900 mb-4">Why Upcycle?</h3>
                      <div className="space-y-4">
                        {[
                          { icon: 'üåç', title: 'Reduce Landfill', desc: 'Keep waste out of landfills' },
                          { icon: '‚ôªÔ∏è', title: 'Save Resources', desc: 'Reduce consumption of new materials' },
                          { icon: 'üí°', title: 'Get Creative', desc: 'Discover unique DIY projects' },
                          { icon: 'üí∞', title: 'Save Money', desc: 'Create useful items for free' }
                        ].map((item, idx) => (
                          <div key={idx} className="flex items-start space-x-3">
                            <span className="text-2xl">{item.icon}</span>
                            <div>
                              <h4 className="font-semibold text-gray-900">{item.title}</h4>
                              <p className="text-sm text-gray-600">{item.desc}</p>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>

                {suggestions && (
                  <div className="animated-gradient-vgr-alt rounded-2xl shadow-2xl p-8 border-4 border-white/30">
                    <h3 className="text-3xl font-bold text-white drop-shadow-lg mb-6 flex items-center">
                      <Lightbulb className="w-8 h-8 mr-3 text-yellow-300" />
                      Your Upcycling Ideas
                    </h3>

                    <div className="mb-6 p-5 bg-white/95 backdrop-blur-sm rounded-xl shadow-lg">
                      <h4 className="font-semibold text-blue-900 mb-3 text-lg">Identified Items:</h4>
                      <div className="flex flex-wrap gap-2">
                        {suggestions.identified_items?.map((item, idx) => (
                          <span key={idx} className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">{item}</span>
                        ))}
                      </div>
                    </div>

                    <div className="space-y-6">
                      {suggestions.suggestions?.map((suggestion, idx) => (
                        <div key={idx} className="bg-white/95 backdrop-blur-sm border-4 border-white/50 rounded-xl p-6 hover:border-yellow-300 transition-all shadow-lg hover:shadow-2xl">
                          <div className="flex items-start justify-between mb-3">
                            <h4 className="text-xl font-bold text-gray-900">{suggestion.title}</h4>
                            <span className={`px-3 py-1 rounded-full text-xs font-semibold ${getDifficultyColor(suggestion.difficulty)}`}>
                              {suggestion.difficulty}
                            </span>
                          </div>
                          <p className="text-gray-700 mb-4">{suggestion.description}</p>
                          
                          {suggestion.materials_needed?.length > 0 && (
                            <div className="mb-4">
                              <h5 className="font-semibold text-gray-900 mb-2">Materials Needed:</h5>
                              <div className="flex flex-wrap gap-2">
                                {suggestion.materials_needed.map((material, i) => (
                                  <span key={i} className="px-2 py-1 bg-gray-100 text-gray-700 rounded text-sm">{material}</span>
                                ))}
                              </div>
                            </div>
                          )}
                          
                          {suggestion.steps?.length > 0 && (
                            <div>
                              <h5 className="font-semibold text-gray-900 mb-2">Steps:</h5>
                              <ol className="space-y-2">
                                {suggestion.steps.map((step, i) => (
                                  <li key={i} className="flex items-start space-x-2">
                                    <CheckCircle className="w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5" />
                                    <span className="text-gray-700">{step}</span>
                                  </li>
                                ))}
                              </ol>
                            </div>
                          )}
                        </div>
                      ))}
                    </div>

                    {suggestions.environmental_impact && (
                      <div className="mt-6 p-5 bg-white/95 backdrop-blur-sm rounded-xl border-4 border-green-300 shadow-lg">
                        <h4 className="font-semibold text-green-900 mb-2 flex items-center">
                          <span className="text-xl mr-2">üå±</span>
                          Environmental Impact
                        </h4>
                        <p className="text-green-800">{suggestions.environmental_impact}</p>
                      </div>
                    )}
                  </div>
                )}
              </main>

              {showModal && (
                <div className="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50">
                  <div className="animated-gradient-vgr rounded-3xl max-w-2xl w-full p-8 relative max-h-[90vh] overflow-y-auto border-4 border-white/30 shadow-2xl">
                    <button onClick={() => setShowModal(false)} className="absolute top-4 right-4 text-white hover:text-yellow-300 bg-white/20 backdrop-blur-sm p-2 rounded-full transition-all hover:bg-white/30">
                      <X className="w-6 h-6" />
                    </button>
                    
                    <h3 className="text-3xl font-bold text-white drop-shadow-lg mb-6">How EcoTransform Works</h3>
                    
                    <div className="space-y-6">
                      {[
                        { step: 1, title: 'Capture', desc: 'Take a photo or upload an image of your waste items using your mobile camera or device storage.' },
                        { step: 2, title: 'Analyze', desc: 'Our AI analyzes the image to identify materials and assess their upcycling potential.' },
                        { step: 3, title: 'Discover', desc: 'Get creative, practical suggestions for transforming waste into useful products.' },
                        { step: 4, title: 'Create', desc: 'Follow step-by-step instructions to complete your upcycling project!' }
                      ].map((item) => (
                        <div key={item.step} className="flex items-start space-x-4 bg-white/95 backdrop-blur-sm rounded-xl p-4 shadow-lg">
                          <div className="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 text-white rounded-full flex items-center justify-center font-bold text-lg shadow-lg">
                            {item.step}
                          </div>
                          <div>
                            <h4 className="font-bold text-gray-900 mb-1 text-lg">{item.title}</h4>
                            <p className="text-gray-700">{item.desc}</p>
                          </div>
                        </div>
                      ))}
                    </div>

                    <div className="mt-8 p-4 bg-white/95 backdrop-blur-sm rounded-xl shadow-lg border-2 border-yellow-300">
                      <p className="text-sm text-gray-800 font-medium">
                        <strong className="text-purple-700">Tip:</strong> For best results, take clear photos in good lighting with the waste item visible and distinct from the background.
                      </p>
                    </div>
                  </div>
                </div>
              )}

              <footer className="animated-gradient-vgr-alt border-t-4 border-white/30 mt-16 shadow-2xl">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                  <p className="text-center text-white font-semibold text-lg drop-shadow-lg">
                    Powered by AI. Making sustainability accessible to everyone. üåç
                  </p>
                </div>
              </footer>
            </div>
          );
        }

        ReactDOM.render(<WasteToProductApp />, document.getElementById('root'));
    </script>
</body>
</html>
